/*! geo-app 2014-09-13 */
var geo=geo||{};!function(){"use strict";geo.app={init:function(){geo.helpers.debugMessage("Check if gps is available"),geo.config.settings=this.settings,ET.addListener(geo.config.gpsAvailable,geo.gps.startInterval),ET.addListener(geo.config.gpsUnavailable,function(){geo.helpers.debugMessage("Gps not available")}),ET.fire(geo_position_js.init()?geo.config.gpsAvailable:geo.config.gpsUnavailable)}}}();var geo=geo||{};!function(){"use strict";geo.config={sanbox:"SANDBOX",lineair:"LINEAIR",gpsAvailable:"GPS_AVAILABLE",gpsUnavailable:"GPS_UNAVAILABLE",positionUpdated:"POSITION_UPDATED",refreshRate:1e3,currentPosition:!1,currentPositionMarker:!1,customDebugging:!1,debugId:!1,map:!1,interval:!1,intervalCounter:!1,updateMap:!1,locatieRij:!1,locations:[]}}();var geo=geo||{};!function(){geo.gps={startInterval:function(){geo.helpers.debugMessage("Gps is available, ask position"),geo.gps.updatePosition(),geo.config.interval=self.setInterval(geo.gps.updatePosition,geo.config.refreshRate),ET.addListener(geo.config.positionUpdated,geo.gps.checkLocations)},updatePosition:function(){geo.config.intervalCounter++,geo_position_js.getCurrentPosition(geo.gps.setPosition,geo.helpers.geoErrorHandler,{enableHighAccuracy:!0})},setPosition:function(a){geo.config.currentPosition=a,ET.fire("POSITION_UPDATED"),geo.helpers.debugMessage(geo.config.intervalCounter+" positie lat:"+geo.config.currentPosition.coords.latitude+" long:"+geo.config.currentPosition.coords.longitude)},checkLocations:function(){for(var a=0;a<geo.config.locations.length;a++){var b={coords:{latitude:geo.config.locations[a][3],longitude:geo.config.locations[a][4]}};if(this.calculateDistance(b,geo.config.currentPosition)<geo.config.locations[a][2]&&window.location!=geo.config.locations[a][1]&&"false"==localStorage[geo.config.locations[a][0]]){try{"false"==localStorage[geo.config.locations[a][0]]?localStorage[geo.config.locations[a][0]]=1:localStorage[geo.config.locations[a][0]]++}catch(c){geo.helpers.debugMessage("Localstorage kan niet aangesproken worden: "+c)}window.location=geo.config.locations[a][1],geo.helpers.debugMessage("Speler is binnen een straal van "+geo.config.locations[a][2]+" meter van "+geo.config.locations[a][0])}}},calculateDistance:function(a,b){var c=new google.maps.LatLng(a.coords.latitude,a.coords.longitude),d=new google.maps.LatLng(b.coords.latitude,b.coords.longitude);return Math.round(google.maps.geometry.spherical.computeDistanceBetween(c,d),0)}}}();var geo=geo||{};!function(){"use strict";geo.helpers={isNumber:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},geoErrorHandler:function(a,b){geo.helpers.debugMessage("geo.js error: "+a+": "+b)},debugMessage:function(a){geo.config.customDebugging&&geo.config.debugId?document.getElementById(geo.config.debugId).innerHTML:console.log(a)},setCustomDebugging:function(){geo.config.debugId=this.debugId,geo.condig.customDebugging=!0}}}();var geo=geo||{};!function(){"use strict";geo.map={routeList:[],markerLatLng:!1,markerList:[],marker:!1,generateMap:function(a,b){geo.helpers.debugMessage("Genereer een Google Maps kaart en toon deze in #"+b),geo.config.map=new google.maps.Map(document.getElementById(b),a),geo.helpers.debugMessage("Locaties intekenen, tourtype is: "+tourType);for(var c=0;c<geo.config.locations.length;c++){try{void 0==localStorage.visited||geo.helpers.isNumber(localStorage.visited)?localStorage[geo.config.locations[c][0]]=!1:null}catch(d){geo.helpers.debugMessage("Localstorage kan niet aangesproken worden: "+d)}this.markerLatLng=new google.maps.LatLng(geo.config.locations[c][3],geo.config.locations[c][4]),this.routeList.push(this.markerLatLng),this.markerList[c]={};for(var e in locatieMarker)this.markerList[c][e]=locatieMarker[e];this.markerList[c].scale=geo.config.locations[c][2]/3,this.marker=new google.maps.Marker({position:markerLatLng,map:map,icon:this.markerList[c],title:geo.config.locations[c][0]})}if(tourType==geo.config.lineair){geo.helpers.debugMessage("Route intekenen");{new google.maps.Polyline({clickable:!1,map:map,path:routeList,strokeColor:"Black",strokeOpacity:.6,strokeWeight:3})}}currentPositionMarker=new google.maps.Marker({position:kaartOpties.center,map:map,icon:positieMarker,title:"U bevindt zich hier"}),ET.addListener(geo.config.positionUpdated,geo.gps.updatePosition)}}}();